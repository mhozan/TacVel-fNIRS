<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024b"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S1 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-size: 14px;  }
.S2 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S3 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S7 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent button {    user-select: none;    -webkit-user-select: none;}
.embeddedOutputsErrorElement .eoOutputContent ::selection {}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsWarningElement .eoOutputContent ::selection {}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2023 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: var(--mw-color-matlabWarning) !important;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: var(--mw-color-matlabErrors) !important;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.embeddedOutputsTextElement.activeOutput .eoOutputContent,.embeddedOutputsVariableStringElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
/*embeddedOutputsTextElement has a different dom structure than embeddedOutputsVariableStringElement.Unlike variableString, the text output has both TEXT nodes and elements as children. Hence we needa selector for each.*/.embeddedOutputsTextElement .eoOutputContent::selection,.embeddedOutputsTextElement .eoOutputContent ::selection,.embeddedOutputsVariableStringElement .eoOutputContent ::selection {}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S9 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><div  class = 'S0'><span style=' font-weight: bold;'>Demo on using parametric linear models</span></div><div  class = 'S0'><span style=' text-decoration: underline;'>What is a parametric linear model?</span></div><div  class = 'S0'><span>    The purpose of a parametric linear model is test parameter such as reaction-time, a behavioral metric, or variables such as repetition (in the case of learning/habituation models) on the time-course of the data.  This is a first-level statistical model (e.g. done in the GLM step).  Parameters that can be used are anything that changes over the time of a scan of data.</span></div><div  class = 'S0'><span>Examples:</span></div><ul  class = 'S1'><li  class = 'S2'><span> Motor-learning.  Use the block number (repetition or time elapsed in the task) as a covariate in the model</span></li><li  class = 'S2'><span>Reaction time, accuracy, or other behavioral metrics that can be assigned to a single event block.  E.g. The subject did 10 blocks of a task; how did the brain activity vary between high and low accuracy blocks?</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% For this problem, let's just generate a simple block design </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% simulated data set.  We aren't putting any modulations into</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% the simulation, so all of our parametric tests should be null,</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% but we can show how to do these models</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% In the simData functions, you can pass it a particular stimulus </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% design instead of using the default event related model</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% This will take either a specific stimulus dictionary or the funciton</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% handle to one of the stimulusgenerating functions.</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Here, we are asking for a block design task with 20s on, 20s off, and 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% type of tasks.</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >stimfcn = @(time)nirs.testing.blockedStimDesign(time,20,20,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >raw = nirs.testing.simData([],stimfcn);</span></span></div></div></div><div  class = 'S6'><span>A parametric linear model uses the "amplitude" field in the stimulus events object.  In most studies, this amplitude is just a column of ones, but we can use this to encode hypotheses of how the amplitude of event blocks vary over time.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >stim = raw.stimulus(</span><span style="color: #a709f5;">'A'</span><span >);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >disp(stim);</span></span></div><div  class = 'S8'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="64F96421" prevent-scroll="true" data-testid="output_0" style="width: 834px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="797" data-previous-scroll-height="135" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">  StimulusEvents with properties:

                     name: 'A'
                    onset: [30.6002 70.6002 110.6002 150.6002 190.6002 230.6002 270.6002]
                      dur: [20 20 20 20 20 20 20]
                      amp: [1 1 1 1 1 1 1]
    regressor_no_interest: 0
                 metadata: [0×0 table]
                    count: 7</div></div></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Let's create a new regressor based on event A, that tests how repeated</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% trials of A change the brain activity</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >stimA_mod = stim;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >stimA_mod.amp =[-3 -2 -1 0 1 2 3];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% We are now using a variable amplitude.  The values we are using are</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% symetric around 0 (mean 0).  </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw.stimulus(</span><span style="color: #a709f5;">'A_mod'</span><span >)=stimA_mod;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >raw.draw([]);</span></span></div></div></div><div  class = 'S6'><span>We can see we now have two regressors (A and A_mod).  </span></div><ul  class = 'S1'><li  class = 'S2'><span>A is constant over all blocks.  This regressor will test if the average brain response was non-zero</span></li></ul><ul  class = 'S1'><li  class = 'S2'><span>A_mod varies per block.  The first block is negative, the second is less negative, the 4th is 0, the last is positive (etc).  This regressor will test if the brain varied linearly across the scan based on repetitions of the task</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >job = nirs.modules.OpticalDensity;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >job = nirs.modules.BeerLambertLaw(job);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >job = nirs.modules.Resample(job);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >job = nirs.modules.GLM(job);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >Stats= job.run(raw);</span></span></div><div  class = 'S8'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="52E9AE08" prevent-scroll="true" data-testid="output_1" style="width: 834px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="797" data-previous-scroll-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">................................Finished    1 of    1.</div></div></div></div></div><div  class = 'S6'><span>  In our stats variable, we now have two terms.  </span></div><ul  class = 'S1'><li  class = 'S2'><span>A - intepret this as the average brain response across all the blocks.</span></li><li  class = 'S2'><span>A_mod - intepret this as the "slope" of how brain activity varied with repeated trials.  Because we sloped the amplitude up (-3--&gt; +3), a positive effect on this statistic means the brain activity increased with repetition.</span></li></ul><div  class = 'S0'><span>If you don't center the variable (e.g. the amplitude is 1,2,3,4,5,6,7 instead of zero-mean), then the slope ("A_mod") will be the same, but now the main term ("A") will reflect the brain response where parameter encoded by amplitude (repetition in this case) is 0.</span></div><div  class = 'S0'><span></span></div><div  class = 'S0'><span style=' font-weight: bold;'> Example 2.</span></div><div  class = 'S0'><span>We can modify the ampltude field directly as we just did or there are tools to help us do this.</span></div><div  class = 'S0'><span>The tools (which is called "nirs.design.split_parametric") allows us to used several variables</span></div><ul  class = 'S1'><li  class = 'S2'><span>time (experimental time)</span></li><li  class = 'S2'><span>duration (duration of the event)</span></li><li  class = 'S2'><span>amp (anything encoded on the amp field already)</span></li><li  class = 'S2'><span>metadata (a table on the StimEvents that can encode anything).  Metadata can be continious, ordinal, or categorical.</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% Let's clean off what we already did </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw.stimulus=raw.stimulus.remove(</span><span style="color: #a709f5;">'A_mod'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Let's start by creating some metadata on the events to show the options</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >metadata.reactiontime = 100+rand(7,1)*20;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >metadata.accuracy = rand(7,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >metadata.correct = (randn(7,1)&gt;.5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >metadata.score = ordinal({</span><span style="color: #a709f5;">'low'</span><span >,</span><span style="color: #a709f5;">'medium'</span><span >,</span><span style="color: #a709f5;">'high'</span><span >,</span><span style="color: #a709f5;">'low'</span><span >,</span><span style="color: #a709f5;">'high'</span><span >,</span><span style="color: #a709f5;">'low'</span><span >,</span><span style="color: #a709f5;">'medium'</span><span >}',{</span><span style="color: #a709f5;">'low'</span><span >,</span><span style="color: #a709f5;">'medium'</span><span >,</span><span style="color: #a709f5;">'high'</span><span >});</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >metadata=struct2table(metadata);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >disp(metadata);</span></span></div><div  class = 'S8'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="C8057432" prevent-scroll="true" data-testid="output_2" style="width: 834px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="797" data-previous-scroll-height="150" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">reactiontime</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">accuracy</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">correct</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">score</strong> 
    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">____________</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">________</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">_______</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">______</strong>

       105.43       0.61001      false     medium
       110.46       0.25182      false     high  
       115.71       0.51146      false     low   
       101.85       0.42011      true      medium
       105.44       0.27587      false     low   
       110.98       0.72816      false     medium
       107.87       0.96569      false     high  </div></div></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >stim=raw.stimulus(</span><span style="color: #a709f5;">'A'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >stim.metadata=metadata;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw.stimulus(</span><span style="color: #a709f5;">'A'</span><span >)=stim;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw.draw([]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% We can see, we are back to a simple single regressor.  We added the</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% metadata information, but haven't told the code how to use this</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: #008013;">% information yet.</span></span></div></div></div><div  class = 'S6'><span>data=nirs.design.split_parametric(data,formula,centervariables,normalize)</span></div><div  class = 'S0'><span>Inputs: </span></div><ul  class = 'S1'><li  class = 'S2'><span>data-  the time-course fNIRS variable (e.g. "raw") </span></li><li  class = 'S2'><span>formula- a string formula that will be used to make the modulated regressors (see below)</span></li><li  class = 'S2'><span>centervariables (optional; default = true).  If true, this will center the parameter as we did in the first example where we centered the amplitude of the repeated blocks</span></li><li  class = 'S2'><span>normalize (optional; default = true).  If true, it will rescale the values of the parameters.  This will mathmatically be more stable and won't change the T-statistic, but if you want to know the units on the beta (GLM coefficients), you need to unscale.  This does change the interpretation of the variables when you go to the group-level model (e.g. combine the "slopes" from multiple subjects).</span></li></ul><div  class = 'S0'><span>The formula:</span></div><div  class = 'S0'><span>The formula used in this function is a string that tells the code how to make the regressor.</span></div><div  class = 'S0'><span>Examples:</span></div><ul  class = 'S1'><li  class = 'S2'><span>?*(1+Amp) -&gt; results in two regressors per original condition name, with the first constant (amp=1) and the second modulated by whatever info was in the Amp field.  The first part ("?") tells the code to do this for every condition type in the scan</span></li><li  class = 'S2'><span>A*(1 + Amp) --&gt;   Same as above, only just do this to a condition named "A"</span></li><li  class = 'S2'><span>A?*(1 + Amp) --&gt; Do this for all conditions that start with "A" (e.g. A1, A2, A3...)</span></li><li  class = 'S2'><span>A*(1+accuracy) --&gt; Any variable names in metadata can be used.  This will now give a constant term (the "1" part) and a term that varies with the continious variable "accuracy" that we added to the metadata table in the last part</span></li><li  class = 'S2'><span>A*(1+accuracy+accuracy^2) --&gt; 3 regressors, a constant, a linear, and a quadric term with accuracy</span></li><li  class = 'S2'><span>A*(correct) --&gt; This will split A into correct and incorrect responses.  "correct" is logical/boolean in the metadata table, so you don't want to also include the intercept term anymore.  Logicals are a special case of categorical variables.  All categorical variables would be done the same as this example  </span></li><li  class = 'S2'><span>A*(score) --&gt; Ordinal variables are cetgorical variables but with order.  E.g. low, medium, high.  Behind the scenes, ordinal variables are modeled as low = X1.  medium = X1 + X2.  high = X1+X2+X3, such that the parameters you estimate are actually the change between levels (e.g. X3 = the change from medium to high).</span></li></ul><div  class = 'S0'><span> </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >raw = nirs.design.split_parametric(raw,</span><span style="color: #a709f5;">'A*(1+reactiontime)'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >raw.draw([]);</span></span></div><div  class = 'S8'><img src="data:image/png;base64,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"></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">% We now have two regressors, the A term is the average brain response and</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% the A_reactiontime is how the brain varies with reaction time.  Since</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% this is a positive slope, a more positive statistic would mean brain activity went up with higher reaction time</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% We can do this again and now split the correct and incorrect responses</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw = nirs.design.split_parametric(raw,</span><span style="color: #a709f5;">'A*(correct)'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Right now the code DOES NOT remove events, so we have both "A" and</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% "A_true" and "A_false" as terms.  Since all events are either true or</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% false, we need to get rid of the "A" term</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% However, since "A" is the variable that is holding the metadata, we don't</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% want to get rid of it till we are fully done with building regressors</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% from it.</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >job=nirs.modules.DiscardStims;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >job.listOfStims={</span><span style="color: #a709f5;">'A'</span><span >};</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw=job.run(raw); </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'>&nbsp;</div></div></div><div  class = 'S6'><span style=' font-weight: bold;'>Example 3.</span><span> </span></div><div  class = 'S0'><span>Time modulation is a bit of a special case.  The previous examples showed how to use the ampltude field to look at parameters that varied by repeated block (e.g. compare how repeat block 1 differs from 2, etc).  But modulation can also be used to look at how the brain varies more continiously too.  For example, how did the brain activity vary over the duration of the a 30s block.</span></div><div  class = 'S0'><span>For this, we use the function nirs.design.time_parmod</span></div><div  class = 'S0'><span>This does the modulation modules treating amplitude as a continious factor over the events rather and thus uses the StimulusVector class of regressors instead of the StimulusEvents class</span></div><div  class = 'S0'><span></span></div><div  class = 'S0'><span style=' text-decoration: underline;'>Usage:</span></div><div  class = 'S0'><span>stim=nirs.design.time_parmod(stim,time,center,reset)</span></div><div  class = 'S0'><span>    Inputs:</span></div><ul  class = 'S1'><li  class = 'S2'><span>stim-  This function takes the StimEvents object rather than the time-course data class</span></li><li  class = 'S2'><span>time-  The modulation variable.  The code should work to use any variable that has the same length as the scan (e.g. an auxillary variable for example), but it was built to deal specifically with time</span></li><li  class = 'S2'><span>center-  A true/false variable of whether or not to center time.  See the dicussion above about centering variables and how this effects interpretion</span></li><li  class = 'S2'><span>rest- A true/false variable of whether to restart for each block or continue across blocks.  For example, if you had a motor learning task with 30second blocks.  For each block, the subject does a DIFFERENT motor sequence and repeats it for the 30s.  Here, you would want reset to be true, because you want to model the learning effect within a 30s block, but then in the next block, you need to relearn the sequence.      </span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% Let's just create clean dataset to play with</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >stimfcn = @(time)nirs.testing.blockedStimDesign(time,20,20,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw = nirs.testing.simData([],stimfcn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >center=true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >reset = true;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >stim = nirs.design.time_parmod(raw.stimulus(</span><span style="color: #a709f5;">'A'</span><span >),raw.time,center,reset)</span></span></div><div  class = 'S8'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement scrollableOutput" uid="41BFB573" prevent-scroll="true" data-testid="output_4" style="width: 834px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent scrollArea" data-previous-available-width="797" data-previous-scroll-height="123" data-hashorizontaloverflow="true" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " tabindex="-1"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">stim = </span></div><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">  StimulusVector with properties:

                     name: 'A_pmod'
                   vector: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 … ] (1×3001 double)
                     time: [0 0.1000 0.2000 0.3000 0.4000 0.5000 0.6000 0.7000 0.8000 0.9000 1 1.1000 1.2000 1.3000 1.4000 1.5000 1.6000 1.7000 1.8000 1.9000 2 2.1000 2.2000 2.3000 2.4000 2.5000 2.6000 2.7000 2.8000 2.9000 3 3.1000 … ] (1×3001 double)
    regressor_no_interest: 0
      convolve_by_default: 1
</div></div></div></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Note, there is a new field in StimVectors called </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% stim.convolve_by_default </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% This determines the default behavior of whether to convolve with a HRF or</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% not.</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >stim.draw;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >raw.stimulus(</span><span style="color: #a709f5;">'A_learning'</span><span >)=stim;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >raw.draw([]);</span></span></div><div  class = 'S8'><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANAAAACcCAYAAAAOPiVjAAAAAXNSR0IArs4c6QAAIABJREFUeF7tXQmcT9UXPzNmBmPNkD1btJAkyZKiSIuSKBVaKKWN0u5va5ElopRUIpQSLYRQRIhQSqJVsmTPZBnMMP/P90zv5/3evOW+9/vd93u/n3s/n/nMzO93373nnnu+79x77jnnJuXm5uaSKooDigOeOJCkAOSJb+ohxQHmgAKQEgTFgQg4oAAUAfPUo4oDCkBKBhQHIuCAAlAEzFOPKg4oACkZUByIgAMKQBEwTz2qOKAApGRAcSACDigARcA89ajigAKQkgHFgQg4EPcA6tKlC33zzTcRsEA9erJwoGHDhjRp0qSoDjfuAXTGGWfQzz//HFWm+NVYvNKu6D4hIQpAfqHFpB8liP4yXwa/FYD8ncOw3l5++WV64IEHYkiBt67jlW4FoAR6i3sTXfVUJBxQAFIAikR+TvpnFYBiDCBl8YsfDJpZ3BSAYgwgGRMQPyIZX5SazZWM+VNGBBdyIWMCXHSvqrrggAKQILP8FGo/+xIcvqpmwQEFIEHR8FOo/exLcPiqmgJQZDLgp1D72VdkXLF/ev369XTKKadQuXLlZHYT07aVBhJkv59C7WdfgsN3Xe2vv/6iKlWqUKtWrWjevHmun4+XBxSABGfKT6H2sy/B4buuNmTIEJo4cSL99NNPtHnzZqpUqZLrNuLhgYQA0AcffEBr166lp59+OsTzP/74g8aPH0/ff/891atXj3r27EkZGRn8/bp16+jVV1+lDRs2UPny5emuu+6iSy65xHa+/BRqP/uSIaTIoXn66afTiy++SAMHDqROnTrRww8/LKOrmLcZ1wD6888/6euvv6Zhw4YxSN566y1m6JEjR+i6666jGjVqULt27di1/MCBAzRt2jTKzMykFi1a0OWXX06tW7emmTNn0qxZs2jlypVUvHhxywnxU6jN+ho4dyMNmLcx5gJjJGDA5dWof+tqYR8vW7aMrrjiCtq1axe/qN58801+aSViiWsAvfbaa/T555/Tli1b6Oyzzw4BaO7cufTggw/SmjVrqHDhwgRtdOWVV9KSJUtY69x55528tChQoABlZWUx+AYNGkTt27cPLIDiSfh69OhBANG9995LmzZtoueff57n4txzz42nYQjRGtcA0kYIDQSLj6aBAKzly5fThAkTuEp2djbVqVOH34SVK1emrVu3UtOmTfm73377ja6++mrCMrBu3boKQEJiY13p4MGDVLRoUerWrRuVLFmSK0LLYyUwePDgCFsP3uMJCaA+ffrQoUOHeA2ulcsuu4zuuOMO6ty5c+izpUuXUu/evQlMePvttx33QFqF+++/X2p4gJ/LxWiL5JQpU+ixxx4jWOGSkpK4eRgTHn30UX5xpaSkRLvLmLannyuEX4wePZrpiXbwpVRXHqMGwkBWr14d0kAYUKNGjei5554jAAnLtqeeeopmz57Nm9uuXbtSamqqI4CizRSrDuMZQNj7NGnShPr16xca3t69e9mAg+U2+J9IJSE10MKFC3kCv/rqK56rf//9ly644AI+j8BEQhMVLFiQYGqtWLGi0Hz6KdR+9iU0eFXJ1dJexvz5qoF27NhBF198MQME5unhw4fz2w8bWxgYevXqRe+++y6VKFEixBgAC6fmQdAKMiZAYUAOBxJGA/3yyy/0xhtvhLiEtfiAAQP4/yJFivByDkYCWIQ044KepX379g3bHxnZ7adQ+9mXHLE6eVpNCABZTRcsQtu2baPq1auzyTqS4qdQ+9lXJDxRzxIboIx7YxnzJ3UJ58dEymBKEJaLMnnnxpn077//ZlLgGSKr4GWanJwcVedWBSDB2VIAEmTUf9XcOpM++eSTLNywlMoqsLgWK1aM3YuiVRSABDkZawAdWreMstZ9LUitf9UK125M6bWb5OvQrTOpEUDHjh0jmL/LlCmTr+3t27fTqaeeyoBD0e6vxoE53Liw58V3OAs8evRo6EAXf+NsCkcWaB/L+n/++Ye9VQoVKhTq5/jx4/wsDoSdigKQE4f++z4IANrSv4Mgtf5Vy7ixN+FHX7w4k+oB9MknnxASq+zfv5/3rx9++CG7AS1atIgNPQACzvJef/11uummm/hM79tvv6XvvvuOnn32WT7MhB8kLK9oA4flL7zwAh/wAlw4CC9dujTdcMMN9Nlnn3Ed9AFvCRyuw+0Ln8FDBX6S8KPEc2ZFAUhQ1hSAzBllBiAvzqQagJ555hmOI4ITKg5d4WE/f/58Phjv2LEjOwDj4BuCDX/H33//nfDsK6+8QgBes2bNGGxw3YIHBM7+rr32WsrJyWFvCCzhkGQSmg2eKvgbnivwjZwxYwY7GQOUACrACHpwjojnFIAEwSLKqAias33UDKxYwsWLBvLiTKoBCMIOr5H+/fszj3bu3Eljxoyhw4cP8897773HVq8vvviCNm7cyMKNZ/ft28f1UGrXrs0aB5oE2gPCv2fPHgaEHkDwzIcHPkAGcH355ZdUqlQp7gcH7do+TgEoCpIeaw2EIQBEQSvG/Y9XZ1INQDj47tChQ9iZHsZ8/fXXswMw9j633XYbYZ+COC4NQHoDBAAEjdS8eXPey2D5tXv3bjZQ6AGE/VJaWhov9bDMAzjh1Y8xpKenM3jLli2rNFA0hC4IAIrGOGS34dWZVAMQNA/2J1i2IWkhPOhHjhzJcV/wHMFe57zzzmMNhSVYNAGEPpC/Ae3C3Qve41jeKQ0UBalRABJjoldnUhgCYBXDnuOdd96hJ554ImQswH4HextoCXibAEhXXXUVad4m0C7as6ASe6CXXnqJ3bg0DYQlHDQQLGvYOwGkRg2E6GUs5wBOhMNceumltGDBAm4DljrRpb0MWQk7SIUFBQFWIgVOoEFwgZfBFKvx+9mXyBxEqw42/MiPYCwQ6gYNGoR9jE0/6sOgoDcxw88RyyssxSDYsPhZWcjc0o22AN42bdpwH4iixXISdLiZKxnzFwYghGLDmiJScCuc3ulT5BkZdWQwxc2kyBiT322uWrWKrV3Ggo07hDYIBQYQvNwhn9Bw3bt3Z83nZq5kyEoYgIB0WEdQoFqxQYTFpG3btlS1alVOEIKEIFCzI0aMCB2YWQ3CbVIRu4Qjbhgla8JlTIAsWk/2dmN+DvTxxx/zZm3x4sVsEdEKYulhk//000+pZs2apvPkJamIXcIRO2HwU6j97OtkB0Ck4485gCZPnsxaBjZ4fVYcqFEcnCHPgZa/wDhYL0lFYMWxSjhi5jai9emnUKvrTSIVa/+ej/n1JvDYRQoqWEywhKtVqxavk7GEg60fLhZORgQ3SUWwMbRKOAJLTxCWcP5Nv+pJBgdkvGxtwxnmzJnDHrJw7NMKDsxwGGaXKUerawSQXVIRAFYk4YiRsWCKVmQnFZExqapN+RyIaVIRmLaRsw1GBYAHAgt3CpHiJqkItJtdwhGlgUQ4rur4vV+21UDQPGPHjuU0vPBpqlatGl1zzTVsRBCJJDUCyC6pCCxwVglHcOagAKTAESkHfF3Cwe8IDoQAEZwINXcNWNjgEYtcBU7FCCC7pCJIN2uVcESLLzHrTwZTnMalvo9PDsiQFUsNNHXqVDZjYx8Exz2tQIvcc889hN8VKlSw5SQAJJpUBA1ZJRzxWy3Hp3goqp044CuAhg4dyhkrR40aFUYXIgbhGYugKaebE6wGZJdUxG3CERlMcZoI9X18ckCGrFhqIJwDwWSNYCh9CC3iPZCcHJoJUYmxLjKYEusxqf7lcECGrFgCCFY3hM7CIbBly5Z8DvTjjz8yoBDPgUPWIBQZTAnCuBQN0eeADFmxtcIhshARhAhs0goOVRElaOcdEP2hW7cogyl+0q/68o8DMmRFKC8cnEyRzAGu6lpmf/+Gbd+TDKYEZWyKjuhyQIas2AIIkYBIRAHzs7EguCla8R6RsEkGUyKhRz0bXA7IkBVLACFGBHdoAiSwuhkLHEZF8nPJZqcMpsimWbUfGw7IkBVLACF90fTp0zk/l9MdPbFhR16vMpgSy/GovuVxQIasWAII8UDI/QUPaX08kLzheWtZBlO8UaKeCjoHZMiKJYAQmQqXHWgf+L/pvRHAKCR2CIJmksGUoAuCos8bB2TIiiWAcMM2fOHgGWBWTsacCN6mTT0VFA74CiBc7osr5pHXwMzjIAgGBLUHCopoxgcdvgIIeyAEIuEQNZpnP7gfFUn5kF3yoosuYrcg7QpHRKVOmzYtlPsLqYsQQmFXZDAlPsRBUemWAzJkxXIJhyss4HVw8803c2i38Z5Sq4R2doPSQiOQ7QchEvC3w+HsuHHjOFlf48aNOTEfci0gnSuWjwCUApBbUVH1zTjgK4CggR5//HHLmfCyB8JyEJkpkekHWu2HH37gqyyQZRJxRsjuv3LlSk5igvaRxAN1jQYMPVEymKLELzE5IENWLDUQQhnMku1prIVDqVsrHHIpLFmyhON+UBArBAsflnT16tXjLJg33ngjB9YhEyWiYAFkpYESU6D9HpWvALIaHK6wgFc2wqzr16/vmFxR3w7CtpGoEbekIVM/Dmtnz57NDqsIE8dFSzi41Uq3bt34MycAad+rpCJ+i2R89BfTpCJ6FuH6ChSAZ8WKFXTmmWfmC7hzYim8GyZNmkTIwgMwIa4IS7tff/2VbzTD3uecc87hxI1YQjrFHcl4qziNQX0fnxyQIStC3thgF/Yr8H+D1kBBZCo2/Ai6cwrt1tiNG5+xLDvrrLP4ZjKcNSHXMbLxIAIWS0bNaKBFvsKU3r59e8sZk8GU+BQPRbUTB2TIijCAEGCHJRIyksICBw9taBDcj2l1zZ5xQPDuvv3221mrZGRk8HUVuIAWeyNY5HCFxoQJE3gvhOsscHszvMFR16rIYIrTRKjv45MDMmRFGEAaYMA6HKxiP4MColCgnZxua0BGUyzLEBYOEzWehQYDQJAbG/fEYOmmeT/07NmTz4mc9kDYl6miOODEgZgCCJoCpmYULL2wbNOnm8KBp1OqX22ACM7DPZiVKlXKN2b0g3tfYLo2nj2ZMUgGU5wmQn0fnxyQISvCGghLOCy9YFbGNSdezoFksF0GU2TQqdqMPQdkyIotgJDWF7czADT4jYJ7guBkiotkgxDmIIMpsZ9qRYEMDsiQlXwAgvUL0agzZ85k87K+wMSMi2SDVGQwJUjjU7REjwMyZCUMQPBVg2UNvxHKjev98D9ca+C/prnZRG9IkbckgymRU6VaCCIHZMhKGIC03NUYPEzW7dq1440+rFxYtikABVEsFE2iHJAOIKSvwg10H330Eb3//vtMF27jxrINqXwVgESnStULIgekA0g/aBgQ4CWNfRAOQFFatWrFWglxPKJ3BMlmpAymyKZZtR8bDsiQFSEz9rZt29iogBsbcAaE/ZEbDwSZ7JLBFJn0qrZjxwEZsiIEIG3IWOLhMmAtVigIYd0ymBK7KVY9y+SADFlxBSCZg/PatgymeKVFPRdsDsiQFQWgYM85U5d77DAlFSgUKEqzdy+n1NKNAkWTEzEJASC7pCJwF0J+BDibIuaoe/fu7JltV0SZ8ksH+9v00EfpW/MuTy517UbLLkXaKVAiiU5pmxaVtjSaTrnqZ0pKyWvTWP7o0ZBydm1xkp+ojU+jiXJ7Uqm2vUz73TmuD+2bM953mnKPVaWMdgtN+xWVFUeidRV81UB2SUWQI+G+++5jJ9MePXrQ3Llz2ZSOPZddEnsRpogIfYnLUym1XHKINVYgcmortWwylWidGnE7aKB4i1RKqxw5TfqXA/5Orz2YCtXomE9ONvdvT1nr8iyuVqVI/RQqXKdAVMYXAiIRpZRqRMUvygv115fNA2+grLVLbWkS5bmIrLgBD+r6CiC7pCIAFwLntAhUuBQheA8HuJHe0u1W6MEYMwDtmTqc8GNXijdPpbTTTgh94TN6UuEz8r+lnWgyCr0VTYfWLaMt/TvY0lSwWjIVa3YC1FY0iQBIL/TotFiTKfmWciI0GYU+JaMRFW9qAiABUIvQBFrjHkB2SUUQqYp4IC2Irm7dunxDnl1GHlGm6IW1cO3G+YQtrcJ3lFo+N+xzEQCZtVXk/G/D2hEFkLGt1HL7Ka3ir440GYU1Xztlkymt0iohmowAEmlLBEAifBIFkEhbZjSJykqgNZBdUhHEGo0ePZrfEjiwRWAdPnO6DVwL6MPArZKKGAFUeeD0MD7tnZE/eaMIgCoNnEbptZuE2sr6dQxlrR8qJKx2NGGDvn/Zzfnm0owmI4AybuxN+NGKWVuiwlpr2jZHPokAyEgTGjXy3CtN/y69mXL2LA+j00hTYJKKuEWnWX2rpCLz589ndyEtDxw8IZDqasCAAZzc0aqIqGU7Yc3aMIKyfnlZSFiNSzg9gKyEXkQD4a2qB3X27q9p/7JbIqbJTFDxmVdhNXvReAGQmdB7ocmK5wmrgeySisDTYdiwYRyop0W2NmvWjB588EFOvigDQFYTYLXfsAXQzsW0f3le1iJ98QIgM0H1QlM0AWQm9GjfLYCseO4FQG5oSoglnF1SkU2bNnFuOKS2QnJFWOGQP8Ep8jUSDXQ8ayvtm3+RKTbdLuGshD6WALKiya2w2r1o3ALISujd0mT1crACdUIAyC6pCAaI5R0ApJW+ffvyHUV2JRIAWQmYl7e9vq3c7FxKSk1ist0CKFo02Qm9W2G1EnovGihaoHZLU0IASAOCXVIR7H3gsFq+fHmhO1i9AsgoYElpJSn36L4QVt1oIDuhdwMgI03Z2487nk1ZLSvtBMwtgPTjM9JUqMY7YYYUMNDKsGGkSd+WG5qc+GRGU0IByFaluPwSAPp62FHhpw6urs8bdjuhF2ks9zhR4ZrvEM4z9BaznF1plFJGnB70pdFkFDAIldHC5ESbJjz68XlpZ/fEIwQrnJEmvBCyfh7lREbY97mH76filzYN41MkNO1f0ZWyd5zwNnDTlp2XiatB/VfZ14NULwQ6PeMWQGA2hEAv9KnlWlJu9gFPwpqz7+Ww57AnMDNB241De/sahR7PeAGQkSYIjZcXhnEsoDO19IWeAJRWeQ1l71oSYoMXPmlLRiN/3YBaAcggiV4AZBRMMHX/8mGUvTMvbbFoMRMwnKa7FVYIphlN+MxtW0ZhMgOn6PhSSjemnN0nXHs0g4Fbmsw0hFdQp9fuQ4fWPZdvqS1KkwKQCYC+GXOh4VO40hz/77MUyslcREkF8v43TqZ+7Z29cz0dWv8c0TF4PhuXYWlEBbLoWOayUF/GtvQWqcyFnYly4fyZQ5SbRJQEo4JGE1FO5tIQTUaBDtsP5B6nzMVdiI7B0TUn/zgLZAvRhH3Doe9fIUpKgX83EdageXaOUMn5ZxklpR6zxJde+DIXdSI6Bp84NAIvDo3nyUQFcuhY5gn/NbgyZf08Mp/Qg6aDa8ZRUvIR3fNatbx23dD076JOlHvsv/FxM6AJ7eAnh776agm16Z+XUTdaJSGWcE6pfe32A1aHbmYMhhBYrf+tNsFWE2X3xowVTWH7neQ0ouMnXiJu39xurYlWfLK1tjWaQKmnXiKMBRGDk3Bj/1U86QCkZ5BbobcDkBuhBw1uzblWExtGE7RL7gkt5Vbo7YTVTVu250aNJ1NqmabCcurFXG3VuAKQCWdEmGIlrG6F3gpAboFoByA3gop27EDtti23J/tWgur24NUOTVY0pdfpR4Wq3yEMRFQUkRVXDfodzuCWOJH6IkwxA5AXobcSVreC6geA3L4cQJNsABU5dxAVrGLt12g231Y0eeG5iKyIyJy+zkm7hPMyAbIB5EXoo0mTmbAWqT+CClZq50qu3HiTOzVsRlNqucupWMOxTo/m+14BKIpLuGgByIvQW2kgLzSZCWvRBq9QWoWrXAuYmbBGi6a0Cm2oaIP8Xu9ORIqEKzi1oX2vABQlAHkVerO3vRcBMwNQ0QajKa3C1aKyEKpnBiCvNBmFteBpN1KRekOiQpNXnpt5Z5hFrooQmRAAsksqojEBObpvvfVWvgKySZMTAWtmTBJhinEP5FXAjAAq2XIJJadXFJm7fHWiRZMRQIWqd6X0On090WQUVq9Cb6TJy35TG0C0aEoII4JTUhEMErkQcL09Qh9wbWSLFi1shcEtgEq2/IqS0/PfjCcqcXrB9wpEowYqVONOwgm716KnyavQo+/9K7pR9o4FTEZK6UZUvEn+HAWiNEaLpuOHd9K+eXkH5ZEAMSEAZJdUpGLFvDf5m2++yWmtkI0nWgBCu8cP76DkQmVF59+23vFDWyICYVSIMDRydOsMSqt4rYymPbd5dNssT8tS0w7Zc+JEshYvRIm8bN2266sVzi6pCKJPf/zxR166zZgxg7PxDB8+PCoayC1TVP3E5EDcA8guqQiWam3btqUHHniArrvuOqpfv74wgLTptkoqkpjioEYlyoGTIqnIJ598QsuWLaPnn3+e+dKxY0cO6UaYt9lt3hrzZLxVRCdG1YsvDsiQFV+XcHZJRZATDvserSClFa6579KlC2cstSoymBJfYqGoFeWADFnxFUB2SUWMTHCzhHPyxhZlsN/1sLTAkjXeSrzSHfcAckoqohekRo0a0ZAhQ+iSS+zd1WUwxS+BjlfaFd0nJMRXDaR1a5dUxK3wYomH1FeqKA44caBhw4Y0adIkp2quvo8JgFxRqCorDgSYAwpAAZ4cRVrwOaAAFPw5UhQGmAMKQAGeHEVa8DmgABT8OVIUBpgDCkABnhxFWvA5oAAU/DlSFAaYAwpAAZ4cRVrwOaAAFPw5UhQGmAMKQAGeHEVa8DmgABT8OVIUBpgDCkABnhxFWvA5ENcAmjx5Ms2ePZvS0tL4IuKrr3afFkrmFG3YsIEeeughmjNnTlg3dnTHekw5OTk0ZswYzkuB2wKRFenhhx+mYsWK8RiCSvuBAwc4gnn58uVUrVo1uuyyy6h9+/YhvsuiO24BhAjWxx57jAYNGsQT/cwzz9Drr7/uGP4gEzBa28g+hOja8ePH09q1a0kfr2RHdxDGhFgf0D1w4EDm64gRI+iWW27h29KDTDtkYfHixdS9e3eeBoTCvPvuu3T++edLpTtuAdS6dWu6/vrr6e6772aGPfroo1SiRAn63//+5wdGbPtA7rtRo0YRgIT7XvUAsqM7CGPq0KEDXXPNNXTbbbfxGJEIBiEAeLMHlfbc3FwGij4JDcaB8AUASybdcQkgLDNq164desNgoseOHUuff/45IXVWUMqiRYv4jagByI7uKVOmBGJMWLrVqVOHypbNSwGG5RuWR6+++qolfUGgHekCSpcuTXv37qVVq1Yx3UiLhmxPVrISDbrjEkB4q2ON++mnn1LNmjV5omfNmsVMC1J4txFAdnRDcIM0JgQ9Dhs2jN5//32aMGECVa5c2ZK+INEObaPl05g6dSolJydLpTsuAYS1eb169cI00PTp0+ntt9/mnHJBKUYA2dENQQ3KmEA3jB/Vq1cnJHtBCHe80I7l3MaNG/llWrJkSTaIWPE1GjyPSwABIMgdd/vtt/NvFKx/d+3aRYMHDw4KfsgIICe6gzAmTZPDKIN9BN7gWrGjL5a0Q7Pfe++9NG7cOCpTpgyTiwy3+MHeTSbdcQsgWIlWr17NG1xkNO3duzcbEvSmy1gjyQxAdnQHYUxYAjVo0IDuuOPE7W8AEbRRkGnH8vfiiy9mIB08eJCthkhIA7mQSXfcAgibRWggbc+Dtwy0TxLfhh2MYgYgO7pjPSb037hxY1Pmgc9Bph1nbb169QrRjtTQjzzyCBtDZNIdtwDSOIUNI8zXSMIYT8WO7qCPKai0Q/Ns3bqVDR6FCxfOJw4y6I57AMUTaBSticcBBaDEm9OojCg7O5twbmX2Jo9KBwnSiAJQgkxktIfxxhtv8Nnaxx9/HO2mE6o9BaCEms7oDUYBSIyXCkBifIp6rW3btvE5EcqFF17IZmKtwC1lxYoVdPToUfbxqlGjRug7HBTCaRKe3rVq1aILLriAihYtyt/jsHPBggV8Eo8b/1q1akVFihTh79asWUOpqamUnp7OZyNYmsHNJSMjg79H3nL0uXnzZjrzzDP5b70GgmfCkiVLCLTVrVuXTd2qECkAxUAKsCzC3UcwGQMIcDrVPIfhxY2LwlBOO+00Wr9+PfXr1486derEn8E5El7RuL0C18EAIBB0/O7cuTM7r0K4f/jhBwbMhx9+yIeLMPHCMxzfn3XWWdxu1apV2XOjYMGCoXZhzQQ9aA/9g1bNBemcc87hMxZclPbEE0+EnRXFgI2B6FIBKAbTgEM/3D4BNxlcqgxhhLDC8bRly5b8hn/hhRdYS8BJFiEF0Bo//fQTde3alT2kUU+7tBkHyIcOHeLPoZ1w9rFnzx6Oj8LBKA4SASCclQBQcK7Uzk0AoN27d3O7AwYM4IvN/vrrL/Z01wAELw8ACV7mKBMnTmRNBx+5k70oAMVAAnALH4QPp/1NmzZljQGwrFu3jgUXQIKGQdm+fTsLNtxScAsFYp6gPTQXG2gDaJCePXvycgyA08qTTz7JbQIkABC0B/Y2KJmZmezuD4/llStXshsMtBbaQkF7mzZtYuDAyx2XnF155ZUMSCw5S5UqFQPOBa9LBaAYzAn2EwhagxYAAFAADOxD7rnnHt4PwRFSXwCAjz76iLWQmcMsNBqicuG6ohV4ZmB5B82B5wE6aDMUhChgfwUAzZw5k3777bewdl966SXWMpoVDq7/qAf3KRR1H20elxWAfAbQkSNHOAwDflvYm2BT3qdPH3Y3gWaCS9LIkSP5ba9pCmiA5s2bs98fvIthENDOZ7A8gyZ566232EAAj3StAFDYy0DbAUDYEyFEwQggxM9Aw+nbxX4KIAOA5s+fz6f7MC4A/AA7frBf04wQPrMxMN0pAMVgKuCnhQ05HB4h4AgdgHYYPXo0tWnThooXL059+/Zl6xo0BgR16dKlrK2wxEOIdbdu3ejLL7/kUHbE48ybN4/DmPEcQIhlGbTZ0KFD+fZzOwDBcIC9DwCHZ2B62IBBAAAA5ElEQVSBe+qpp9jYAABBkwFkzz77LFsEobWgQUHTyX7QqgAUAwAtXLiQsD+BEQAFYIImweYeTpvwKIblCwXC/eKLL4acPLGUwp5I+w77JRgAoNkAHljotAJnWxgYUlJSGEBIvgJAGTVQixYtWIMBgFqBAQKABYBgFgfYNcdd3JqO/wHMk70oAMVIAnDGgw1+hQoVQuHTGilwocEGHnVOP/10XnrpC857duzYQVWqVMnnfb5z507CDyxo0GRuCgANowX2YJoxQf88TO4AI2hSJY8DCkBKEhQHIuCAAlAEzFOPKg78H04mYpUAD86FAAAAAElFTkSuQmCC"></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div></div><div  class = 'S6'><span> </span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% 
% *Demo on using parametric linear models*
% 
% What is a parametric linear model?
% 
% The purpose of a parametric linear model is test parameter such as reaction-time, 
% a behavioral metric, or variables such as repetition (in the case of learning/habituation 
% models) on the time-course of the data.  This is a first-level statistical model 
% (e.g. done in the GLM step).  Parameters that can be used are anything that 
% changes over the time of a scan of data.
% 
% Examples:
%% 
% * Motor-learning.  Use the block number (repetition or time elapsed in the 
% task) as a covariate in the model
% * Reaction time, accuracy, or other behavioral metrics that can be assigned 
% to a single event block.  E.g. The subject did 10 blocks of a task; how did 
% the brain activity vary between high and low accuracy blocks?

% For this problem, let's just generate a simple block design 
% simulated data set.  We aren't putting any modulations into
% the simulation, so all of our parametric tests should be null,
% but we can show how to do these models

% In the simData functions, you can pass it a particular stimulus 
% design instead of using the default event related model
% This will take either a specific stimulus dictionary or the funciton
% handle to one of the stimulusgenerating functions.
% Here, we are asking for a block design task with 20s on, 20s off, and 1
% type of tasks.
stimfcn = @(time)nirs.testing.blockedStimDesign(time,20,20,1);
raw = nirs.testing.simData([],stimfcn);
%% 
% A parametric linear model uses the "amplitude" field in the stimulus events 
% object.  In most studies, this amplitude is just a column of ones, but we can 
% use this to encode hypotheses of how the amplitude of event blocks vary over 
% time.

stim = raw.stimulus('A');
disp(stim);

% Let's create a new regressor based on event A, that tests how repeated
% trials of A change the brain activity

stimA_mod = stim;
stimA_mod.amp =[-3 -2 -1 0 1 2 3];
% We are now using a variable amplitude.  The values we are using are
% symetric around 0 (mean 0).  

raw.stimulus('A_mod')=stimA_mod;

raw.draw([]);
%% 
% We can see we now have two regressors (A and A_mod).  
%% 
% * A is constant over all blocks.  This regressor will test if the average 
% brain response was non-zero
%% 
% * A_mod varies per block.  The first block is negative, the second is less 
% negative, the 4th is 0, the last is positive (etc).  This regressor will test 
% if the brain varied linearly across the scan based on repetitions of the task

job = nirs.modules.OpticalDensity;
job = nirs.modules.BeerLambertLaw(job);
job = nirs.modules.Resample(job);
job = nirs.modules.GLM(job);

Stats= job.run(raw);
%% 
% In our stats variable, we now have two terms.  
%% 
% * A - intepret this as the average brain response across all the blocks.
% * A_mod - intepret this as the "slope" of how brain activity varied with repeated 
% trials.  Because we sloped the amplitude up (-3REPLACE_WITH_DASH_DASH> +3), a positive effect on 
% this statistic means the brain activity increased with repetition.
%% 
% If you don't center the variable (e.g. the amplitude is 1,2,3,4,5,6,7 instead 
% of zero-mean), then the slope ("A_mod") will be the same, but now the main term 
% ("A") will reflect the brain response where parameter encoded by amplitude (repetition 
% in this case) is 0.
% 
% 
% 
% *Example 2.*
% 
% We can modify the ampltude field directly as we just did or there are tools 
% to help us do this.
% 
% The tools (which is called "nirs.design.split_parametric") allows us to used 
% several variables
%% 
% * time (experimental time)
% * duration (duration of the event)
% * amp (anything encoded on the amp field already)
% * metadata (a table on the StimEvents that can encode anything).  Metadata 
% can be continious, ordinal, or categorical.

% Let's clean off what we already did 
raw.stimulus=raw.stimulus.remove('A_mod');

% Let's start by creating some metadata on the events to show the options

metadata.reactiontime = 100+rand(7,1)*20;
metadata.accuracy = rand(7,1);
metadata.correct = (randn(7,1)>.5);
metadata.score = ordinal({'low','medium','high','low','high','low','medium'}',{'low','medium','high'});

metadata=struct2table(metadata);
disp(metadata);

stim=raw.stimulus('A');
stim.metadata=metadata;
raw.stimulus('A')=stim;

raw.draw([]);
% We can see, we are back to a simple single regressor.  We added the
% metadata information, but haven't told the code how to use this
% information yet.
%% 
% data=nirs.design.split_parametric(data,formula,centervariables,normalize)
% 
% Inputs: 
%% 
% * data-  the time-course fNIRS variable (e.g. "raw") 
% * formula- a string formula that will be used to make the modulated regressors 
% (see below)
% * centervariables (optional; default = true).  If true, this will center the 
% parameter as we did in the first example where we centered the amplitude of 
% the repeated blocks
% * normalize (optional; default = true).  If true, it will rescale the values 
% of the parameters.  This will mathmatically be more stable and won't change 
% the T-statistic, but if you want to know the units on the beta (GLM coefficients), 
% you need to unscale.  This does change the interpretation of the variables when 
% you go to the group-level model (e.g. combine the "slopes" from multiple subjects).
%% 
% The formula:
% 
% The formula used in this function is a string that tells the code how to make 
% the regressor.
% 
% Examples:
%% 
% * ?*(1+Amp) -> results in two regressors per original condition name, with 
% the first constant (amp=1) and the second modulated by whatever info was in 
% the Amp field.  The first part ("?") tells the code to do this for every condition 
% type in the scan
% * A*(1 + Amp) REPLACE_WITH_DASH_DASH>   Same as above, only just do this to a condition named 
% "A"
% * A?*(1 + Amp) REPLACE_WITH_DASH_DASH> Do this for all conditions that start with "A" (e.g. A1, 
% A2, A3...)
% * A*(1+accuracy) REPLACE_WITH_DASH_DASH> Any variable names in metadata can be used.  This will 
% now give a constant term (the "1" part) and a term that varies with the continious 
% variable "accuracy" that we added to the metadata table in the last part
% * A*(1+accuracy+accuracy^2) REPLACE_WITH_DASH_DASH> 3 regressors, a constant, a linear, and a 
% quadric term with accuracy
% * A*(correct) REPLACE_WITH_DASH_DASH> This will split A into correct and incorrect responses.  
% "correct" is logical/boolean in the metadata table, so you don't want to also 
% include the intercept term anymore.  Logicals are a special case of categorical 
% variables.  All categorical variables would be done the same as this example  
% * A*(score) REPLACE_WITH_DASH_DASH> Ordinal variables are cetgorical variables but with order.  
% E.g. low, medium, high.  Behind the scenes, ordinal variables are modeled as 
% low = X1.  medium = X1 + X2.  high = X1+X2+X3, such that the parameters you 
% estimate are actually the change between levels (e.g. X3 = the change from medium 
% to high).
%% 
% 

raw = nirs.design.split_parametric(raw,'A*(1+reactiontime)');

raw.draw([]);
% We now have two regressors, the A term is the average brain response and
% the A_reactiontime is how the brain varies with reaction time.  Since
% this is a positive slope, a more positive statistic would mean brain activity went up with higher reaction time

% We can do this again and now split the correct and incorrect responses
raw = nirs.design.split_parametric(raw,'A*(correct)');

% Right now the code DOES NOT remove events, so we have both "A" and
% "A_true" and "A_false" as terms.  Since all events are either true or
% false, we need to get rid of the "A" term

% However, since "A" is the variable that is holding the metadata, we don't
% want to get rid of it till we are fully done with building regressors
% from it.
job=nirs.modules.DiscardStims;
job.listOfStims={'A'};
raw=job.run(raw); 

%% 
% *Example 3.* 
% 
% Time modulation is a bit of a special case.  The previous examples showed 
% how to use the ampltude field to look at parameters that varied by repeated 
% block (e.g. compare how repeat block 1 differs from 2, etc).  But modulation 
% can also be used to look at how the brain varies more continiously too.  For 
% example, how did the brain activity vary over the duration of the a 30s block.
% 
% For this, we use the function nirs.design.time_parmod
% 
% This does the modulation modules treating amplitude as a continious factor 
% over the events rather and thus uses the StimulusVector class of regressors 
% instead of the StimulusEvents class
% 
% 
% 
% Usage:
% 
% stim=nirs.design.time_parmod(stim,time,center,reset)
% 
% Inputs:
%% 
% * stim-  This function takes the StimEvents object rather than the time-course 
% data class
% * time-  The modulation variable.  The code should work to use any variable 
% that has the same length as the scan (e.g. an auxillary variable for example), 
% but it was built to deal specifically with time
% * center-  A true/false variable of whether or not to center time.  See the 
% dicussion above about centering variables and how this effects interpretion
% * rest- A true/false variable of whether to restart for each block or continue 
% across blocks.  For example, if you had a motor learning task with 30second 
% blocks.  For each block, the subject does a DIFFERENT motor sequence and repeats 
% it for the 30s.  Here, you would want reset to be true, because you want to 
% model the learning effect within a 30s block, but then in the next block, you 
% need to relearn the sequence.      

% Let's just create clean dataset to play with
stimfcn = @(time)nirs.testing.blockedStimDesign(time,20,20,1);
raw = nirs.testing.simData([],stimfcn);


center=true;
reset = true;
stim = nirs.design.time_parmod(raw.stimulus('A'),raw.time,center,reset)

% Note, there is a new field in StimVectors called 
% stim.convolve_by_default 
% This determines the default behavior of whether to convolve with a HRF or
% not.

stim.draw;

raw.stimulus('A_learning')=stim;
raw.draw([]);

%% 
%
##### SOURCE END #####
-->
</div></body></html>